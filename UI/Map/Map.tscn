[gd_scene load_steps=7 format=2]

[ext_resource path="res://UI/Map/Map.gd" type="Script" id=1]
[ext_resource path="res://UI/Map/MapTiles.tscn" type="PackedScene" id=2]
[ext_resource path="res://UI/Assets/MapPositionMarker.png" type="Texture" id=3]
[ext_resource path="res://UI/Assets/MapAlpha.png" type="Texture" id=4]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;

uniform sampler2D alpha;

const float PI = 3.14;

void fragment() {
	vec4 color = texture(TEXTURE, UV);
	float beforeA = 1.0-color.a;
	color.a = texture(alpha, SCREEN_UV).r;
	color.a = mix(color.a, 0.0, beforeA);

	COLOR = color;
}"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )
shader_param/alpha = ExtResource( 4 )

[node name="Map" type="ViewportContainer"]
anchor_left = 1.0
anchor_right = 1.0
margin_left = -60.0
margin_bottom = 60.0
script = ExtResource( 1 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Viewport" type="Viewport" parent="."]
size = Vector2( 60, 60 )
transparent_bg = true
handle_input_locally = false
usage = 0
render_target_update_mode = 3

[node name="MapTiles" parent="Viewport" instance=ExtResource( 2 )]
material = SubResource( 2 )

[node name="Player" type="Sprite" parent="Viewport"]
texture = ExtResource( 3 )

[node name="Camera" type="Camera2D" parent="Viewport"]
current = true
